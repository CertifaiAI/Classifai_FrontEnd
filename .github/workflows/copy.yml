name: Copy to Repo Classifai Job
on:
  push:
    branches: main

    paths:
      # Triggered when only this path has code changes during push
      - 'dist/classifai/**'

jobs:
  copy:
    name: Copy job
    runs-on: ubuntu-latest
    steps:
      - name: Declare some variables
        id: vars
        shell: bash
        run: | # Set output for branch name & short commit hash
          echo "##[set-output name=branch;]$(echo ${GITHUB_REF#refs/heads/})" 
          echo "##[set-output name=sha_short;]$(echo ${GITHUB_SHA} | cut -c1-7)"

      - name: Copy dist items into Repo Classifai
        uses: andstor/copycat-action@v3
        with:
          commit_message: ':lipstick: Update files from Repo Classifai_FrontEnd, branch ${{ steps.vars.outputs.branch }} at commit ${{ steps.vars.outputs.sha_short }}' # Commit message at repo classifai
          personal_token: ${{ secrets.PERSONAL_TOKEN }} # Personal token to solve permission issue
          src_path: dist/classifai/. # Source to be copied
          dst_path: classifai-core/src/main/resources/webroot/. # Destination to be pasted
          dst_owner: CertifaiAI # Destination owner's name
          dst_repo_name: classifai # Destination repo's name
          src_branch: main # Source repo's branch
          dst_branch: faris_auto_pr # Destination repo's branch / It will create if branch not exist
          clean: true # Set to 'true' for emptying destination path prior pasting 
          